[tool:pytest]
markers =
    unit: marks tests as unit tests
    integration: marks tests as integration tests
    system: marks tests as system tests
    slow: marks tests as slow (deselect with '-m "not slow"')
    fast: marks tests as fast (run with '-m fast')
    spark: marks tests that require Spark
    delta: marks tests that require Delta Lake
    pyspark: marks tests that require real PySpark with Delta Lake (skipped in mock mode)
    batch_mode: marks tests that use batch mode operations (skipped in real mode with Delta Lake)
    performance: marks performance/stress tests
    benchmark: marks benchmark tests
    memory: marks memory usage tests
    security: marks security tests
    mypy: marks tests that require mypy type checking
    no_mypy: marks tests that are exempt from mypy validation
    type_check: marks tests that focus on type safety
    isolation: marks tests that need isolation (run separately)
    parallel_safe: marks tests as safe for parallel execution
    requires_isolation: marks tests that require isolated resources (unique schemas)
    no_parallel: marks tests that should not run in parallel
    # Service type markers
    step_executor: marks tests for step executors
    validator: marks tests for validation services
    storage: marks tests for storage services
    transformation: marks tests for transformation services
    reporting: marks tests for reporting services
    error_handling: marks tests for error handling
    # Test category markers
    happy_path: marks tests as happy path scenarios
    edge_case: marks tests as edge case scenarios
    error_handling: marks tests for error handling scenarios

# Test discovery
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
pythonpath = src

# Output options  
addopts =
    --strict-markers
    --disable-warnings
    --tb=short
    -q
    --durations=10

# Logging
log_cli = true
log_cli_level = WARN
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Environment variables
env =
    SPARK_MODE = mock
    SPARKFORGE_ENGINE = mock
