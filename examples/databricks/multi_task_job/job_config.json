{
  "name": "PipelineBuilder ETL Pipeline",
  "timeout_seconds": 7200,
  "max_concurrent_runs": 1,
  "email_notifications": {
    "on_start": [],
    "on_success": [],
    "on_failure": [],
    "no_alert_for_skipped_runs": false
  },
  "format": "MULTI_TASK",
  "job_clusters": [
    {
      "job_cluster_key": "etl_cluster",
      "new_cluster": {
        "spark_version": "13.3.x-scala2.12",
        "node_type_id": "i3.xlarge",
        "num_workers": 4,
        "autoscale": {
          "min_workers": 2,
          "max_workers": 8
        },
        "spark_conf": {
          "spark.sql.adaptive.enabled": "true",
          "spark.sql.adaptive.coalescePartitions.enabled": "true",
          "spark.databricks.delta.optimizeWrite.enabled": "true",
          "spark.databricks.delta.autoCompact.enabled": "true"
        },
        "spark_env_vars": {
          "PYSPARK_PYTHON": "/databricks/python3/bin/python3"
        },
        "custom_tags": {
          "team": "data-engineering",
          "project": "pipeline_builder-pipeline"
        }
      }
    },
    {
      "job_cluster_key": "small_cluster",
      "new_cluster": {
        "spark_version": "13.3.x-scala2.12",
        "node_type_id": "i3.large",
        "num_workers": 2,
        "spark_conf": {
          "spark.sql.adaptive.enabled": "true"
        }
      }
    }
  ],
  "tasks": [
    {
      "task_key": "bronze_ingestion",
      "description": "Load and validate raw data",
      "job_cluster_key": "etl_cluster",
      "notebook_task": {
        "notebook_path": "/Workspace/pipeline_builder/examples/databricks/multi_task_job/bronze_ingestion",
        "source": "WORKSPACE"
      },
      "timeout_seconds": 1800,
      "max_retries": 2,
      "retry_on_timeout": true,
      "min_retry_interval_millis": 10000
    },
    {
      "task_key": "silver_processing",
      "description": "Clean and enrich data",
      "depends_on": [
        {
          "task_key": "bronze_ingestion"
        }
      ],
      "job_cluster_key": "etl_cluster",
      "notebook_task": {
        "notebook_path": "/Workspace/pipeline_builder/examples/databricks/multi_task_job/silver_processing",
        "source": "WORKSPACE"
      },
      "timeout_seconds": 3600,
      "max_retries": 2,
      "retry_on_timeout": true
    },
    {
      "task_key": "gold_analytics",
      "description": "Create business analytics",
      "depends_on": [
        {
          "task_key": "silver_processing"
        }
      ],
      "job_cluster_key": "etl_cluster",
      "notebook_task": {
        "notebook_path": "/Workspace/pipeline_builder/examples/databricks/multi_task_job/gold_analytics",
        "source": "WORKSPACE"
      },
      "timeout_seconds": 1800,
      "max_retries": 2,
      "retry_on_timeout": true
    },
    {
      "task_key": "log_results",
      "description": "Log execution results and metrics",
      "depends_on": [
        {
          "task_key": "gold_analytics"
        }
      ],
      "job_cluster_key": "small_cluster",
      "notebook_task": {
        "notebook_path": "/Workspace/pipeline_builder/examples/databricks/multi_task_job/log_execution",
        "source": "WORKSPACE"
      },
      "timeout_seconds": 300,
      "max_retries": 3
    }
  ],
  "schedule": {
    "quartz_cron_expression": "0 0 2 * * ?",
    "timezone_id": "America/Los_Angeles",
    "pause_status": "UNPAUSED"
  },
  "access_control_list": [
    {
      "user_name": "admin@company.com",
      "permission_level": "CAN_MANAGE"
    },
    {
      "group_name": "data-engineers",
      "permission_level": "CAN_VIEW"
    }
  ],
  "git_source": {
    "git_url": "https://github.com/your-org/pipeline_builder",
    "git_provider": "gitHub",
    "git_branch": "main"
  }
}

